<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <title>Painel de Administração</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
    <nav class="navbar navbar-light bg-light shadow-sm">
        <div class="container d-flex justify-content-center">
            <a class="navbar-brand d-flex align-items-center" href="/">
                <img src="{{ url_for('static', filename='img/SPORTSLINK.png') }}" alt="Logo" height="30"
                    class="d-inline-block align-text-top me-2">
            </a>
        </div>
    </nav>

    <!-- Navbar para alternar entre tabelas -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light mb-4">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Administração</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" onclick="showTable('usersTable')">Utilizadores</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showTable('fieldsTable')">Campos</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showTable('matchesTable')">Partidas</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showTable('moreOptions')">Mais opções</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="container mt-5">
        <!-- Tabela de Utilizadores -->
        <div id="usersTable" class="table-container">
            <h2>Utilizadores</h2>
            <div class="container mt-5">
                <!-- Motor de Pesquisa -->
                <div class="mb-3">
                    <label for="filterInput" class="form-label">Pesquisar por</label>
                    <input type="text" id="filterInput" class="form-control" placeholder="Escreve para pesquisar..."
                        oninput="filterTable()">
                </div>

                <!-- Ordenar por -->
                <div class="mb-3">
                    <label for="orderSelect" class="form-label">Ordenar por</label>
                    <select id="orderSelect" class="form-select" onchange="sortTable()">
                        <option value="ID">ID</option>
                        <option value="Nome">Nome</option>
                        <option value="Email">Email</option>
                        <option value="Telefone">Telefone</option>
                        <option value="Nacionalidade">Nacionalidade</option>
                        <option value="Idade">Idade</option>
                        <option value="Descrição">Descrição</option>
                        <option value="IBAN">IBAN</option>
                        <option value="Número de Campos">Número de Campos</option>
                    </select>
                </div>

                <!-- Selecionar por tipo -->
                <div class="mb-3">
                    <label for="userTypeSelect" class="form-label">Ordenar por Tipo de Utilizador</label>
                    <select id="userTypeSelect" class="form-select" onchange="filterByUserType()">
                        <option value="todos">Todos</option>
                        <option value="Jogador">Jogador</option>
                        <option value="Arrendador">Arrendador</option>
                    </select>
                </div>

                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nome</th>
                            <th>Email</th>
                            <th>Telefone</th>
                            <th>Nacionalidade</th>
                            <th>Idade</th>
                            <th>Descrição</th>
                            <th>IBAN</th>
                            <th>Número de Campos</th>
                            <th>Tipo</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for user in utilizadores %}
                        <tr>
                            <td>{{ user.ID }}</td>
                            <td>{{ user.Nome }}</td>
                            <td>{{ user.Email }}</td>
                            <td>{{ user.Num_Tele }}</td>
                            <td>{{ user.Nacionalidade }}</td>
                            <td>{{ user.Idade or '---' }}</td>
                            <td>{{ user.Descricao or '---' }}</td>
                            <td>{{ user.IBAN or '---' }}</td>
                            <td>{{ user.No_Campos if user.No_Campos is not none else '---' }}</td>
                            <td class="user-type">{{ 'Jogador' if user.IBAN is none else 'Arrendador' }}</td>
                            <td>
                                <a href="{{ url_for('admin.edit_user', user_id=user.ID) }}" class="btn btn-primary btn-sm">Editar</a>
                                <a href="{{ url_for('admin.delete_user', user_id=user.ID) }}" class="btn btn-danger btn-sm">Excluir</a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Tabela de Campos -->
        <div id="fieldsTable" class="table-container" style="display: none;">
            <h2>Campos</h2>

            <!-- Motor de Pesquisa -->
            <div class="mb-3">
                <label for="filterFieldsInput" class="form-label">Pesquisar Campos</label>
                <input type="text" id="filterFieldsInput" class="form-control" placeholder="Escreve para pesquisar..." oninput="filterFieldsTable()">
            </div>

            <!-- Ordenar por -->
            <div class="mb-3">
                <label for="orderFieldsSelect" class="form-label">Ordenar por</label>
                <select id="orderFieldsSelect" class="form-select" onchange="sortFieldsTable()">
                    <option value="ID">ID</option>
                    <option value="Nome">Nome</option>
                    <option value="Comprimento">Comprimento</option>
                    <option value="Largura">Largura</option>
                    <option value="Ocupado">Ocupado</option>
                </select>
            </div>

            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Nome do Campo</th>
                        <th>Tipo</th>
                        <th>Comprimento</th>
                        <th>Largura</th>
                        <th>Ocupado</th>
                        <th>Descrição</th>
                        <th>Latitude</th>
                        <th>Longitude</th>
                        <th>Responsável</th>
                        <th>Entidade Pública</th>
                    </tr>
                </thead>
                <tbody>
                    {% for campo in campos %}
                    <tr>
                        <td>{{ campo[0] }}</td>
                        <td>{{ 'Público' if campo[8] is not none else 'Privado' }}</td>
                        <td>{{ campo[1] }}</td>
                        <td>{{ campo[2] }}</td>
                        <td>{{ 'Sim' if campo[3] else 'Não' }}</td>
                        <td>{{ campo[4] }}</td>
                        <td>{{ campo[5] }}</td>
                        <td>{{ campo[6] }}</td>
                        <td>{{ campo[7] or '---' }}</td>
                        <td>{{ campo[8] or '---' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Tabela de Partidas -->
        <div id="matchesTable" class="table-container" style="display: none;">
            <h2>Partidas</h2>

            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Data e Hora</th>
                        <th>Campo</th>
                        <th>Número de Jogadores</th>
                        <th>Resultado</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    {% for match in matches %}
                    <tr>
                        <td>{{ match.ID }}</td>
                        <td>{{ match.Data_Hora }}</td>
                        <td>{{ match.Campo }}</td>
                        <td>{{ match.no_jogadores }}</td>
                        <td>{{ match.Resultado }}</td>
                        <td>
                            <a href="{{ url_for('admin.edit_match', match_id=match.ID) }}" class="btn btn-primary">Editar</a>
                            <a href="{{ url_for('admin.delete_match', match_id=match.ID) }}" class="btn btn-danger">Excluir</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Mais Opções -->
        <div id="moreOptions" class="table-container" style="display: none;">
            <h2>Mais Opções</h2>
            <div class="container mt-5">
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addSport">Ver Desportos</button>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#viewRatings">Ver Ratings</button>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addMatchModal">Ver Imagens</button>
            </div>
        </div>

    </main>

    <footer class="bg-light text-center text-lg-start mt-5">
        <div class="text-center p-3">
            © 2025 SportsLink. ADMIN TOOLS.
        </div>
    </footer>

    <script src="/static/js/scripts.js"></script>
</body>

</html>